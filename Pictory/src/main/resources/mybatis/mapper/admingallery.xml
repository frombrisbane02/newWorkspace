<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--  <mapper namespace="com.pictory.springapp.dto.AdminGalleryDTO"> -->
<mapper namespace="mybatis.mapper.admingallery">

	<select id="galleryChart" parameterType="map" resultType="AdminGalleryDTO">
	<![CDATA[ 
	 SELECT
        TO_CHAR(POSTDATE, 'YYYYMMDD') AS dateDay
    ,   COUNT(h.photono) AS photo
    ,   COUNT(s.sno) AS story
    FROM POST p
    LEFT JOIN PHOTO h
        ON p.POSTNO = h.POSTNO
    LEFT JOIN STORY s
        ON p.SNO = s.SNO
	WHERE
	     POSTDATE >= #{startDate} AND POSTDATE < LAST_DAY(TO_DATE(#{endDate}, 'YYYYMMDD')) 
	GROUP BY
	    TO_CHAR(POSTDATE, 'YYYYMMDD')
	   ]]>
	</select>
</mapper>